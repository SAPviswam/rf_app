"use strict";

sap.ui.define(["../control-data", "../utils", "sap/ui/dt/OverlayUtil", "sap/ui/dt/OverlayRegistry", "../ui5-utils", "sap/ui/core/Component", "../../utils/version"], function (___control_data, ___utils, OverlayUtil, OverlayRegistry, ___ui5_utils, Component, ____utils_version) {
  "use strict";

  const buildControlData = ___control_data["buildControlData"];
  const getRuntimeControl = ___utils["getRuntimeControl"];
  const getComponent = ___ui5_utils["getComponent"];
  const isLowerThanMinimalUi5Version = ____utils_version["isLowerThanMinimalUi5Version"];
  const isEditable = function () {
    let id = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';
    let editable = false;
    const control = sap.ui.getCore().byId(id);
    if (!control) {
      const component = getComponent(id);
      if (component) {
        return editable;
      }
    } else {
      let controlOverlay = OverlayRegistry.getOverlay(control);
      if (!controlOverlay?.getDomRef()) {
        //look for closest control
        controlOverlay = OverlayUtil.getClosestOverlayFor(control);
      }
      if (controlOverlay) {
        const runtimeControl = getRuntimeControl(controlOverlay);
        const controlData = buildControlData(runtimeControl, controlOverlay);
        const prop = controlData.properties.find(item => item.isEnabled === true);
        editable = prop !== undefined;
      }
    }
    return editable;
  };

  /**
   * Function that checks if control is reuse component
   *
   * @param controlId id control
   * @param ui5VersionInfo UI5 version information
   * @returns boolean if control is from reused component view
   */
  const isReuseComponent = (controlId, ui5VersionInfo) => {
    if (isLowerThanMinimalUi5Version(ui5VersionInfo, {
      major: 1,
      minor: 115
    })) {
      return false;
    }
    const component = Component.getComponentById(controlId);
    if (!component) {
      return false;
    }
    const manifest = component.getManifest();
    if (!manifest) {
      return false;
    }
    return manifest['sap.app']?.type === 'component';
  };
  var __exports = {
    __esModule: true
  };
  __exports.isEditable = isEditable;
  __exports.isReuseComponent = isReuseComponent;
  return __exports;
});
//# sourceMappingURL=utils.js.map